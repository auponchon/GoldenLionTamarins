Descriptif traitements données GLT
Romain Monassier

Données :
Données d'observation avec composition des groupes (/ semaines) = clean.raw.data.long. Identifiant du GLT = "GLT" ou "Tattoo".
En + : données d'indiv translocalisés (tranlocated_ind) ; d'évènements de dispersion (GLT_movement, 1989-2001) ; de capture (processamento_mld, 1989-2009). 
Format des données :
* 2001-2007 = PDF
* 2009-2022 = Excel



*** CORRECTION DU SEXE

I. Mise à jour des erreurs de typographie (m, M0, S)

II. Correction du sexe

Plusieurs sexes différents (n=43 GLT, soit 2,08% des GLT)
* Si deux valeurs (F/M et NA) : implémenter le sexe majoritaire dans les cellules NA (n=27 GLT)
* Si deux sexes (F + M) (n=16 GLT) : incertitudes sur les individus suivants
   GLT       F     M SexOK
 1 LC12      3    16 NA
 2 LC4       7     5 F
 3 O15       8     1 NA
 4 O16       1     1 NA
 5 PA3       1    17 NA
 6 PR15      1     3 NA
 7 PR8       2    15 NA
 8 PV4      14     1 NA
 9 RL11      3    15 NA
10 RL13      2    15 NA
11 RT1       1    19 NA
12 SE3      17     2 NA
13 SF3       2     9 NA
14 SF4       1    10 NA
15 SK19      2    13 NA
16 ST3       1    19 NA
!!! A vérifier !!!


*** CORRECTION DE L'AGE
Deux sources de données : fichier de Valéria ("BirthDates.xlsx") et données issues de GLT_movement. 

I. Données 1989-2022
Données sources : Utilisation des données de naissance (fichier de Valéria : BirthDates.xlsx) (naissances de 1989 à 2001)
EXCEL :
- Création d'un champ Birth_VR au format texte et à partir de la colonne BirthDate
- Quand le jour n'est pas connu : utilisation de 01/
- Identification des doublons dans le fichier de Valéria : existence de doublons dont les données sont identiques : OL7 OL8 RV6 PT3 OL10 MA3 RV7 + T4 mais qui n'a pas de date de naissance renseignée
R : CF le script
1) Import des fichiers
2) Suppression des GLT dupliqués
3) Filtrer les NAs

II. Données 2001-2022
Import des données (.Rdata)
Traitement dans R
Champ "Birth" de data.clean (Birth_mov)

III. Jointure des deux jeux de données

IV. Verification des erreurs dans les dates de naissance
1) Dates de naissances multiples (de la variable Birth_mov)
SOLUTION : Correction si erreurs évidentes (dates proches, ie < 180 jours)
* Deux dates différentes (n=120 individus) : correction pour les individus aux dates proches, incertitudes sur 52 individus (NA)
 1:  AS14
 2:  AT10
 3:  AT11
 4:  AX17
 5:   AX3
 6:   AX4
 7:   BE4
 8:   BQ1
 9:   BQ2
10:   BQ3
11:   CB5
12:  CM14
13:   DI1
14:   DI2
15:  FA12
16:  FA20
17:  JP23
18:    K3
19:   LB6
20:   LG2
21:   LG3
22:   LG4
23:   MK2
24:   MK7
25: MP119
26: MP176
27: MP177
28: MP272
29:  MP38
30:  MP39
31:  MP44
32:   O20
33:   OL1
34:  OL10
35:  OL18
36:    P8
37:    P9
38:   PR5
39:  RL24
40:   RP3
41:  RV13
42:  RV32
43:  RV33
44:    S6
45:   SF2
46:   SI5
47:  SP31
48:   SP5
49:  ST42
50:  TM19
51:  TR14
52:  TR18
* Trois dates différentes (n=7 GLT) : 1375, AF20, E25, KE10, KE4, RV6, SP23. 
1: 1375 NA
2: AF20
3:  E25
4: KE10
5:  KE4
6:  RV6
7: SP23
* Cinq dates différentes : incertitudes sur FT, IN, TO. Birth = NA.

3) Incohérences entre les dates de naissance renseignées (n=253 GLT)
* Si incohérence : garder la date de naissance issue de BirthDates (dates de naissance données par VR)


3) Différences entre la date de naissance et la date d'émigration de GLT_movement
* Comparaison entre la date de naissance renseignée et la date d'émigration supposée
* Incertitudes sur les individus (n=4)
A7 (deux dates d'émigration : 1993-01-01 et 1996-05-01 = on attribue 1996)
LB6 (deux dates de naissance : 1998-04-01 et 2001-07-01 = on attribue 1998)
CA9 = NA
SK19 = NA


4) Individus observés avant la date de naissance renseignée :
* Calcul de la différence
* NA aux individus dont la différence est négative (n=112 GLT)

5) Individus vus pour la première fois adultes et ayant une date de naissance (n=203 GLT)
* Mettre la date de naissance en NA

6) Individus dont la date de naissance = la date de première observation (n=93 GLT)
* Date de naissance en NA

7) Extraire les individus des mêmes groupes ayant la même date de naissance et une date de naissance qui est égale à la date de première observation
Erreurs : n = 81 GLT



V. Inférer le champ Idade sachant que :
* IN, FN ou TO = Infant (jeune < 1 an) ; JU = juvénile ; SA = subadulte ; AD = adulte. 
On considère que JU < 1, SA = [1-3], AD = > 3.
Méthodes :

1) à partir de la date de naissance Birth_VR 

2) à l'aide d'une date de naissance inferrée depuis Idade
* On extrait les individus observés la première fois comme juvéniles
* On leur attribue une date de naissance fictive qui vaut la date d'observation - 3 mois

3) à l'aide du poids : JU < 400 g et AD > 400 g
POUR LES INDIVIDUS DONT LE POIDS EST CONNU A UNE OU PLUSIEURS DATES
* CAS 1 : individus qui ont un poids adulte à 1 ou plusieurs dates
= On attribue adulte aux observations postérieures à la date de mesure de poids adulte (ie > 400 g)
Le reste ne peut être inféré
* CAS 2 : individus qui ont un poids juvénile à 1 ou plusieurs dates
= On attribue juvéniel aux observations antérieures à la date de mesure de poids juvénile (ie < 400 g)
Le reste ne peut être inféré


4) à l'aide du champ Idade existant
* Examen préalable des inconsistances entre la variable Idade pré-existante et la variable IdadeOK inférée
* Remplir IdadeOK avec Idade là où NA


5) à l'aide de la date de naissance Birth_mov



ERREURS :
1) Incohérences entre le stade et le poids (juvéniles > 400 g et adultes < 400 g)
* Erreurs : juvéniles de plus de 400 g = 95 GLT
* Erreurs : adultes de moins de 400 g = 1 GLT

2) Incohérences dans le stade de vie : adulte qui passe juvénile, etc.
* Vérification manuelle

PREMIERE VERIFICATION
* Majorité des erreurs = adulte qui repasse sub-adulte puis à nouveau adulte
SOLUTION : on considère que les individus sont adultes si leur poids est supérieur à 500 g, sinon on peut laisser sub-adulte pour un poids entre 400 et 500 g au cas par cas et selon les informations disponibles (eg ST23 ou ST24)
* Incertitudes sur : 
 1 AS1  
 2 AT4  
 3 AX15 
 4 BE2  
 5 JP23 
 6 MA9  
 7 MP220
 8 MP243
 9 MP262
10 MP270
11 MP271
12 MP273
13 MP276
14 MP283
15 MP329
16 MP330
17 MP339
18 MP340
19 MP341
20 MP452
21 MP453
22 MP65 
23 MP66 
24 PT3  
25 RT13 
26 SE5  
27 SE6  
28 ST11 
29 ST12 
30 ST32 
31 TR4 

SECONDE VERIFICATION
A FAIRE

V. Regarder les GLT qui n'ont ni Idade ni BirthDate
- en regardant les fichiers source de 2001 à 2009 pour les 15 groupes les plus suivis (individus en fin de bloc)

VI. Quantifier l'erreur
1) Birth_mov
2) Idade

VII. Résumé statistique
RETIRER LES IN, T0, FN (infants)
- Histogramme des poids
- Individus qui ont un sexe/stade renseigné (ou pas)