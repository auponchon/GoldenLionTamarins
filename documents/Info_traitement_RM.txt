Descriptif traitements données GLT
Romain Monassier

Données :
Données d'observation avec composition des groupes (/ semaines) = clean.raw.data.long. Identifiant du GLT = "GLT" ou "Tattoo".
En + : données d'indiv translocalisés (tranlocated_ind) ; d'évènements de dispersion (GLT_movement, 1989-2001) ; de capture (processamento_mld, 1989-2009). 
Format des données :
* 2001-2007 = PDF
* 2009-2022 = Excel



*** CORRECTION DU SEXE

I. Mise à jour des erreurs de typographie (m, M0, S)

II. Correction du sexe

Plusieurs sexes différents (n=43 GLT, soit 2,08% des GLT)
* Si deux valeurs (F/M et NA) : implémenter le sexe majoritaire dans les cellules NA (n=27 GLT)
* Si deux sexes (F + M) (n=16 GLT) : incertitudes sur les individus suivants
   GLT       F     M SexOK
 1 LC12      3    16 NA
 2 LC4       7     5 F
 3 O15       8     1 NA
 4 O16       1     1 NA
 5 PA3       1    17 NA
 6 PR15      1     3 NA
 7 PR8       2    15 NA
 8 PV4      14     1 NA
 9 RL11      3    15 NA
10 RL13      2    15 NA
11 RT1       1    19 M
12 SE3      17     2 NA
13 SF3       2     9 NA
14 SF4       1    10 NA
15 SK19      2    13 NA
16 ST3       1    19 NA


*** CORRECTION DE LA CATEGORIE D'AGE (IDADE)
Deux sources de données : fichier de Valéria ("BirthDates.xlsx") et données issues de GLT_movement. 

I. Données 1989-2022
Données sources : Utilisation des données de naissance (fichier de Valéria : BirthDates.xlsx) (naissances de 1989 à 2001)
EXCEL :
- Création d'un champ Birth_VR au format texte et à partir de la colonne BirthDate
- Quand le jour n'est pas connu : utilisation de 01/
- Identification des doublons dans le fichier de Valéria : existence de doublons dont les données sont identiques : OL7 OL8 RV6 PT3 OL10 MA3 RV7 + T4 mais qui n'a pas de date de naissance renseignée
R : CF le script
1) Import des fichiers
2) Suppression des GLT dupliqués
3) Filtrer les NAs

II. Données 2001-2022
Import des données (.Rdata)
Traitement dans R
Champ "Birth" de data.clean (Birth_mov)

III. Verification des erreurs dans les dates de naissance
1) Dates de naissances multiples (de la variable Birth_mov)
SOLUTION : Correction si erreurs évidentes (dates proches, ie < 180 jours)
* Deux dates différentes (n=120 individus) : correction pour les individus aux dates proches, incertitudes sur 52 individus = Mettre la date de naissance en NA
 1:  AS14
 2:  AT10
 3:  AT11
 4:  AX17
 5:   AX3
 6:   AX4
 7:   BE4
 8:   BQ1
 9:   BQ2
10:   BQ3
11:   CB5
12:  CM14
13:   DI1
14:   DI2
15:  FA12
16:  FA20
17:  JP23
18:    K3
19:   LB6
20:   LG2
21:   LG3
22:   LG4
23:   MK2
24:   MK7
25: MP119
26: MP176
27: MP177
28: MP272
29:  MP38
30:  MP39
31:  MP44
32:   O20
33:   OL1
34:  OL10
35:  OL18
36:    P8
37:    P9
38:   PR5
39:  RL24
40:   RP3
41:  RV13
42:  RV32
43:  RV33
44:    S6
45:   SF2
46:   SI5
47:  SP31
48:   SP5
49:  ST42
50:  TM19
51:  TR14
52:  TR18
* Trois dates différentes (n=7 GLT) : 1375, AF20, E25, KE10, KE4, RV6, SP23. Incertitude restante sur 1375 (NA)
1: 1375 NA
2: AF20
3:  E25
4: KE10
5:  KE4
6:  RV6
7: SP23
* Cinq dates différentes : incertitudes sur FT, IN, TO. Birth = NA.
TOTAL : 53 individus avec NA

2) Incohérences entre les dates de naissance renseignées (n=255 GLT)
* Si incohérence : garder la date de naissance issue de BirthDates (dates de naissance données par VR)

3) Différences entre la date de naissance et la date d'émigration de GLT_movement
* Comparaison entre la date de naissance renseignée et la date d'émigration supposée
* Incertitudes sur les individus (n=3) = Mettre la date de naissance en NA
A7 = NA
CA9 = NA
SK19 = NA

4) Individus observés avant la date de naissance renseignée :
* Calcul de la différence
* Mettre la date de naissance en NA si la différence est négative (n=111 GLT)

5) Individus vus pour la première fois adultes et ayant une date de naissance (n=203 GLT)
* Mettre la date de naissance en NA

6) Individus dont la date de naissance (Birth_mov) = la date de première observation (n=84 GLT)
* Mettre la date de naissance en NA

7) Individus des mêmes groupes ayant la même date de naissance (n=460)
* Quand >= 3 individus : Mettre la date de naissance en NA
* Rajouter error type : Grp_sameBD (si n=3 ou n=4 : Grp_sameBD_?P)

EXPORT des individus avec des dates de naissance erronnées/incertaines (n=454)



IV. Inférer le champ Idade sachant que :
* IN, FN ou TO = Infant (jeune < 1 an) ; JU = juvénile ; SA = subadulte ; AD = adulte. 
On considère que JU < 1, SA = [1-3], AD = > 3.
Méthodes :

1) à partir de la date de naissance Birth_VR 

2) à l'aide d'une date de naissance inferrée depuis Idade
* On extrait les individus observés la première fois comme juvéniles
* On leur attribue une date de naissance fictive qui vaut la date d'observation - 3 mois

3) à l'aide du poids : JU < 400 g et AD > 400 g


4) à l'aide du champ Idade existant
* Examen préalable des inconsistances entre la variable Idade pré-existante et la variable IdadeOK inférée
* Remplir IdadeOK avec Idade là où NA

5) à l'aide de la date de naissance Birth_mov

A CHAQUE FOIS : on remplit le stade de vie à l'aide des Idade connus à certaines dates
* CAS 1 : individus adultes à une ou plusieurs dates
= On attribue adulte aux observations postérieures à la date où l'individu est adulte
* CAS 2 : individus juvéniles à une ou plusieurs dates
= On attribue juvénile aux observations antérieures à la date où l'individu est juvénile
* CAS 3 : individus juvéniles à une ou plusieurs dates
= On attribue adulte aux observations 3 ans postérieures (1095 jours) à la date où l'individu est juvénile



ERREURS :
1) Incohérences entre le stade et le poids (juvéniles > 400 g et adultes < 400 g)
* Erreurs : juvéniles de plus de 400 g = 96 GLT
* Erreurs : adultes de moins de 400 g = 1 GLT

2) Incohérences dans le stade de vie : adulte qui passe juvénile, etc.
* Vérification manuelle

PREMIERE VERIFICATION
* Majorité des erreurs = adulte qui repasse sub-adulte puis à nouveau adulte
SOLUTION : on considère que les individus sont adultes si leur poids est supérieur à 500 g, sinon on peut laisser sub-adulte pour un poids entre 400 et 500 g au cas par cas et selon les informations disponibles (eg ST23 ou ST24)

* Corrections :
        rowid  GLT Idade_correct
  1: obs18279 1336            SA
  2: obs18467 1336            SA
  3: obs23593 1372            SA
  4: obs23594 1373            SA
  5:  obs2918 AS10            AD
  6:  obs3484 AS10            AD
  7:  obs4101 AS10            AD
  8:  obs2921 AS14            AD
  9:  obs3487 AS14            AD
 10:  obs4102 AS14            AD
 11:  obs4675 AS14            AD
 12:  obs1418  AS4            AD
 13:  obs1637  AS5            AD
 14:  obs1408  AS6            AD
 15:  obs1855  AS6            AD
 16:  obs2350  AS6            AD
 17:  obs1638  AS7            AD
 18:  obs2091  AS7            AD
 19:  obs2606  AS7            AD
 20:  obs1409  AS8            AD
 21:  obs2833  AS8            AD
 22:  obs1414  AT5            AD
 23:  obs1860  AT5            AD
 24:  obs2355  AT5            AD
 25:  obs1475 CA18            AD
 26:  obs1921 CA18            AD
 27:  obs1476 CA19            AD
 28:  obs1922 CA19            AD
 29:  obs2423 CA19            AD
 30:  obs1477 CA20            AD
 31:  obs1923 CA20            AD
 32:  obs2424 CA20            AD
 33:  obs1492  DI2            AD
 34:  obs1937  DI2            AD
 35:  obs2440  DI2            AD
 36:  obs3020  DI2            AD
 37:  obs3587  DI2            AD
 38:   obs836  E12            AD
 39:  obs1023  E15            AD
 40:  obs1024  E16            AD
 41:  obs1189  E16            AD
 42:  obs1222  E16            AD
 43:  obs1025  E17            AD
 44:  obs1225  E21            SA
 45:  obs4241  E24            AD
 46:  obs4817  E24            AD
 47:  obs5403  E24            AD
 48:  obs6079  E24            AD
 49:  obs4242  E25            AD
 50:  obs4818  E25            AD
 51:  obs5404  E25            AD
 52:  obs6080  E25            AD
 53:  obs6696  E25            AD
 54:  obs1639 EM11            AD
 55:  obs2092 EM11            AD
 56:  obs1521  ET3            AD
 57:  obs1968  ET3            AD
 58:  obs2473  ET3            AD
 59:  obs3055  ET3            AD
 60:  obs3622  ET3            AD
 61:  obs4253  ET3            AD
 62:  obs1522  ET4            AD
 63:  obs1969  ET4            AD
 64:  obs2474  ET4            AD
 65:  obs3056  ET4            AD
 66:  obs3623  ET4            AD
 67:  obs4254  ET4            AD
 68: obs23611 FA16            AD
 69: obs23612 FA19            AD
 70: obs29078 FA43            AD
 71: obs28716 FA45            JU
 72: obs26290 FP18            JU
 73: obs26555 FP18            JU
 74: obs26855 FP18            JU
 75: obs27134 FP18            JU
 76: obs27429 FP18            JU
 77: obs27755 FP18            JU
 78: obs28762 FP18            SA
 79: obs29517 FP18            SA
 80: obs29913 FP18            SA
 81: obs26291 FP19            JU
 82: obs26556 FP19            JU
 83: obs26856 FP19            JU
 84: obs27135 FP19            JU
 85: obs27430 FP19            JU
 86: obs27756 FP19            JU
 87: obs28763 FP19            SA
 88: obs29839 FP19            SA
 89: obs30292 FP19            SA
 90: obs28764 FP20            JU
 91: obs28765 FP21            JU
 92: obs23613  FP6            AD
 93: obs29064  HP3            SA
 94: obs29065  HP4            SA
 95: obs28927  HP5            JU
 96: obs28928  HP6            JU
 97:  obs2339  JG8            SA
 98:  obs1620  KE1            AD
 99:  obs2069  KE1            AD
100:  obs2584  KE1            AD
101:  obs1251  KE2            SA
102:  obs1501 LC20            AD
103:  obs1946 LC20            AD
104:  obs1503 LC22            AD
105:  obs1948 LC22            AD
106:  obs2451 LC22            AD
107:  obs1504 LC24            AD
108:  obs1949 LC24            AD
109:  obs2452 LC24            AD
110:  obs3032 LC24            AD
111:  obs3599 LC24            AD
112:   obs378  LC4            AD
113:   obs799  LG2            AD
114:   obs473  LG3            SA
115:   obs968 MA11            AD
116:   obs997 MA11            AD
117:  obs1423 MA14            AD
118:  obs1627 MA15            AD
119:  obs1229 MA16            SA
120:  obs1230 MA17            SA
121:  obs1630 MK10            AD
122:  obs2081 MK10            AD
123:  obs2596 MK10            AD
124:  obs4385 MK13            AD
125:  obs4386 MK14            AD
126:   obs859  MK5            SA
127:  obs1126  MK5            AD
128:  obs1270  MK9            SA
129:  obs1404 OL10            AD
130:  obs1849 OL10            AD
131:  obs1645 OL11            AD
132:  obs2098 OL11            AD
133:  obs2523 OL11            AD
134:  obs1646 OL12            AD
135:  obs2099 OL12            AD
136:  obs2618 OL12            AD
137:  obs2760 OL15            AD
138:  obs3362 OL15            AD
139:  obs3932 OL15            AD
140:  obs4573 OL15            AD
141:  obs2761 OL16            AD
142:  obs3477 OL16            AD
143:  obs4094 OL16            AD
144:  obs3209 OL18            AD
145:  obs3776 OL18            AD
146:  obs4406 OL18            AD
147:  obs4956 OL18            AD
148: obs12742 OL3O            SA
149: obs13236 OL3O            SA
150: obs13360 OL3O            SA
151: obs13912 OL3O            SA
152: obs14050 OL3O            SA
153: obs14192 OL3O            SA
154: obs14337 OL3O            SA
155: obs14480 OL3O            SA
156: obs14617 OL3O            SA
157:  obs1137  OL7            AD
158:  obs1559  OL7            AD
159:  obs1845  OL7            AD
160:  obs1421  OL8            AD
161:  obs1534  OL9            AD
162:  obs1981  OL9            AD
163:  obs4432  PA1            AD
164:  obs4989  PA1            AD
165:  obs5619  PA1            AD
166:  obs1284  PI2            AD
167:  obs1298  PI2            AD
168:  obs1688  PI2            AD
169:  obs1300  PI4            AD
170:  obs1367  PI4            AD
171:  obs1689  PI4            AD
172:  obs2142  PI4            AD
173:  obs2667  PI4            AD
174:  obs1275  PI5            SA
175:  obs3250  PI6            AD
176:  obs3820  PI6            AD
177:  obs4451  PI6            AD
178:  obs5008  PI6            AD
179:  obs5639  PI6            AD
180:  obs6315  PI6            AD
181:  obs3265  PT6            AD
182:  obs3835  PT6            AD
183:  obs4475  PT6            AD
184: obs10569 RT14            AD
185: obs11106 RT14            AD
186: obs11836 RT14            AD
187: obs12445 RT14            AD
188:  obs3307 RV10            AD
189:  obs3309 RV12            AD
190:  obs3881 RV12            AD
191:  obs4518 RV12            AD
192:  obs1737  RV2            AD
193:  obs1128  RV4            AD
194:   obs597 SE10            SA
195: obs13252 SI11            SA
196:  obs1742 ST21            AD
197:  obs2193 ST21            AD
198:  obs1120 ST22            SA
199:  obs1121 ST23            SA
200:  obs1122 ST24            SA
201:  obs1210 ST27            SA
202:  obs1211 ST28            SA
203:  obs4585 ST29            AD
204:  obs4587 ST34            AD
205:  obs5139 ST34            AD
206:  obs5794 ST34            AD
207:  obs6468 ST34            AD
208:  obs7075 ST34            AD
209:  obs4588 ST35            AD
210:  obs5140 ST35            AD
211:  obs5795 ST35            AD
212:  obs6469 ST35            AD
213:  obs1810 TR12            AD
214:  obs1814 TR13            AD
215:  obs1155 TR14            SA
216:  obs3391 TR17            AD
217:  obs3963 TR17            AD
218:  obs4613 TR17            AD
219:  obs5166 TR17            AD
220:  obs3392 TR18            AD
221:  obs3964 TR18            AD
222:  obs4602 TR18            AD
223:  obs5154 TR18            AD
224:   obs505  TR2            AD
225: obs29076  UR7            SA
226: obs29857  UR7            AD
227: obs30311  UR7            AD
228:    obs71   W9            SA
229:    obs86   W9            SA

SECONDE VERIFICATION
     rowid  GLT Idade_correct
 1:  obs854  AS3            SA
 2:  obs699  AT3            SA
 3:  obs548 CA13            SA
 4:  obs549 CA14            SA
 5:  obs725 CA15            SA
 6:  obs726 CA16            SA
 7:  obs299 CM13            SA
 8: obs1184  DI1            AD
 9:  obs613  E13            SA
10:  obs211 LA10            SA
11:  obs118  LA7            SA
12:  obs119  LA8            SA
13:  obs557 LC11            SA
14:  obs714 LC14            SA
15:  obs846 MA13            SA
16:  obs397  MA3            SA
17:  obs422  MA5            SA
18:  obs605  MK3            SA
19:  obs606  MK4            SA
20:  obs860  MK6            SA
21: obs1038  MK7            SA
22:  obs274  O13            SA
23:  obs686  OL3            SA
24:  obs687  OL4            SA
25:   obs26   R9            SA
26: obs1115  RV3            SA
27:  obs818 ST16            SA
28:  obs975 ST20            SA
29:  obs364  TR1            SA
30:  obs783  TR8            SA
31:  obs578  WS1            SA
32:  obs579  WS2            SA

TROISIEME VERIFICATION
      rowid  GLT Idade_correct
 1: obs4050 AS14            AD
 2: obs1062  AS5            SA
 3: obs1182 CA19            SA
 4: obs1369  DI2            AD
 5:  obs615  E12            SA
 6: obs1024  E16            SA
 7: obs1025  E17            SA
 8: obs5878  E25            AD
 9: obs1206 LC22            SA
10: obs1045 MA14            SA
11: obs1104 OL10            SA
12: obs2338 OL11            AD
13: obs2760 OL15            SA
14: obs2886 OL15            AD
15: obs3443 OL16            AD
16: obs5207 OL18            AD
17: obs1055  OL7            SA
18: obs1146  OL7            AD
19: obs1056  OL8            SA
20: obs1108  OL9            SA
21: obs3441  PT6            AD
22: obs4011  PT6            AD
23: obs3470 RV12            AD
24: obs1042  RV2            SA
25: obs7165 ST34            AD
26:  obs365  TR2            JU

* Incertitudes sur n=34 :
 1:   AS1
 2:   AT4
 3:  AX15
 4:   BE2
 5:  JP23
 6:   LG1
 7:   LG5
 8:   MA9
 9: MP220
10: MP243
11: MP262
12: MP270
13: MP271
14: MP273
15: MP276
16: MP283
17: MP329
18: MP330
19: MP339
20: MP340
21: MP341
22: MP452
23: MP453
24:  MP65
25:  MP66
26:   PT3
27:  RT13
28:   SE5
29:   SE6
30:   SE7
31:  ST11
32:  ST12
33:  ST32
34:   TR4

V. Regarder les GLT qui n'ont ni Idade ni BirthDate
Export : idade_checks_v4_NA
* Vérification visuelle


VI. Résumé statistique
RETIRER LES IN, T0, FN (infants)
- Histogramme des poids
- Individus qui ont un sexe/stade renseigné (ou pas)